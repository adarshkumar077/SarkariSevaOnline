<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./style/index.css">

    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Bootstrap Icons -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.5.0/font/bootstrap-icons.min.css"
        rel="stylesheet" />
</head>

<body>

    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="./index.html">
            <i class="fas fa-id-card"></i> Sarkari Seva Online
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav"
            aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link" href="./index.html"><i class="fas fa-home"></i> Home</a>
                </li>
            </ul>
        </div>
    </nav>
    <div class="bg-gray-100">
        <div class="container mx-auto px-4 py-8">
            <header class="bg-white shadow rounded-lg mb-8 p-6">
                <h1 class="text-3xl font-bold text-gray-800">Admin Dashboard</h1>
            </header>

            <main class="bg-white shadow rounded-lg p-6">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-semibold text-gray-700">Form Submissions</h2>
                    <button id="refreshBtn"
                        class="bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline transition duration-300 ease-in-out flex items-center">
                        <i class="fas fa-sync-alt mr-2"></i> Refresh Data
                    </button>
                </div>

                <div class="overflow-x-auto">
                    <table id="submissionsTable" class="min-w-full leading-normal">
                        <thead>
                            <tr>
                                <th
                                    class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                    Name</th>
                                <th
                                    class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                    Mobile</th>
                                <th
                                    class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                    District</th>
                                <th
                                    class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                    Category</th>
                                <th
                                    class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                    Submission Date</th>
                                <th
                                    class="px-5 py-3 border-b-2 border-gray-200 bg-gray-100 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                                    Action</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    </table>
                </div>
            </main>
        </div>
    </div>
    <!-- Footer -->
    <footer class="bg-dark text-light pt-5 pb-4">
        <div class="container text-center text-md-left">
            <div class="row text-center text-md-left">

                <!-- About Section -->
                <div class="col-md-3 col-lg-3 col-xl-3 mx-auto mt-3">
                    <h5 class="text-uppercase mb-4 font-weight-bold text-primary">Sarkari Seva Online</h5>
                    <p>
                        Sarkari Seva Online is your one-stop solution for creating and managing important Indian
                        documents online. We aim to simplify the process of obtaining government documents by providing
                        secure and efficient online services.
                    </p>
                </div>

                <!-- Services Section -->
                <div class="col-md-2 col-lg-2 col-xl-2 mx-auto mt-3">
                    <h5 class="text-uppercase mb-4 font-weight-bold text-primary">Services</h5>
                    <p><a href="#" class="text-light" style="text-decoration: none;">PAN Card Application</a></p>
                    <p><a href="#" class="text-light" style="text-decoration: none;">Aadhar Card Update</a></p>
                    <p><a href="#" class="text-light" style="text-decoration: none;">Driving License Renewal</a></p>
                    <p><a href="#" class="text-light" style="text-decoration: none;">Passport Services</a></p>
                </div>

                <!-- Quick Links Section -->
                <div class="col-md-3 col-lg-2 col-xl-2 mx-auto mt-3">
                    <h5 class="text-uppercase mb-4 font-weight-bold text-primary">Quick Links</h5>
                    <p><a href="#" class="text-light" style="text-decoration: none;">About Us</a></p>
                    <p><a href="#" class="text-light" style="text-decoration: none;">Contact Us</a></p>
                    <p><a href="#" class="text-light" style="text-decoration: none;">Privacy Policy</a></p>
                    <p><a href="#" class="text-light" style="text-decoration: none;">Terms of Service</a></p>
                </div>

                <!-- Contact Section -->
                <div class="col-md-4 col-lg-3 col-xl-3 mx-auto mt-3">
                    <h5 class="text-uppercase mb-4 font-weight-bold text-primary">Contact</h5>
                    <p><i class="bi bi-house-door-fill mr-3"></i> Mumbai, India</p>
                    <p><i class="bi bi-envelope-fill mr-3"></i> info@sarkarisevaonline.com</p>
                    <p><i class="bi bi-phone-fill mr-3"></i> +91 9876543210</p>
                    <p><i class="bi bi-printer-fill mr-3"></i> +91 1122334455</p>
                </div>

            </div>

            <hr class="mb-4">

            <!-- Social Media Section -->
            <div class="row align-items-center">
                <div class="col-md-7 col-lg-8">
                    <p class="text-center text-md-left">
                        Â© 2024 Sarkari Seva Online. All Rights Reserved.
                    </p>
                </div>
                <div class="col-md-5 col-lg-4">
                    <div class="text-center text-md-right">
                        <ul class="list-unstyled list-inline">
                            <li class="list-inline-item">
                                <a href="#" class="btn-floating btn-sm text-light" style="font-size: 23px;"><i
                                        class="bi bi-facebook"></i></a>
                            </li>
                            <li class="list-inline-item">
                                <a href="#" class="btn-floating btn-sm text-light" style="font-size: 23px;"><i
                                        class="bi bi-twitter"></i></a>
                            </li>
                            <li class="list-inline-item">
                                <a href="#" class="btn-floating btn-sm text-light" style="font-size: 23px;"><i
                                        class="bi bi-linkedin"></i></a>
                            </li>
                            <li class="list-inline-item">
                                <a href="#" class="btn-floating btn-sm text-light" style="font-size: 23px;"><i
                                        class="bi bi-instagram"></i></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS and dependencies -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.7/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script>
        const fetchSubmissions = async () => {
            try {
                const response = await fetch('http://localhost:3000/admin/submissions');
                if (!response.ok) {
                    throw new Error('Failed to fetch submissions');
                }
                const submissions = await response.json();
                displaySubmissions(submissions);
            } catch (error) {
                console.error('Error:', error);
                alert('An error occurred while fetching submissions');
            }
        };

        const displaySubmissions = (submissions) => {
            const tableBody = document.querySelector('#submissionsTable tbody');
            tableBody.innerHTML = '';

            submissions.forEach(submission => {
                const row = tableBody.insertRow();
                row.innerHTML = `
                    <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                        <p class="text-gray-900 whitespace-no-wrap">${submission.name}</p>
                    </td>
                    <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                        <p class="text-gray-900 whitespace-no-wrap">${submission.mobile}</p>
                    </td>
                    <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                        <p class="text-gray-900 whitespace-no-wrap">${submission.district}</p>
                    </td>
                    <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                        <span class="relative inline-block px-3 py-1 font-semibold text-green-900 leading-tight">
                            <span aria-hidden class="absolute inset-0 bg-green-200 opacity-50 rounded-full"></span>
                            <span class="relative">${submission.category}</span>
                        </span>
                    </td>
                    <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                        <p class="text-gray-900 whitespace-no-wrap">${new Date(submission.createdAt).toLocaleString()}</p>
                    </td>
                    <td class="px-5 py-5 border-b border-gray-200 bg-white text-sm">
                        <button onclick="deleteSubmission('${submission._id}')" class="text-red-600 hover:text-red-900 transition duration-300 ease-in-out">
                            <i class="fas fa-trash-alt"></i> Delete
                        </button>
                    </td>
                `;
            });
        };

        const deleteSubmission = async (id) => {
            if (confirm('Are you sure you want to delete this submission?')) {
                try {
                    const response = await fetch(`http://localhost:3000/admin/submissions/${id}`, {
                        method: 'DELETE',
                    });
                    if (!response.ok) {
                        throw new Error('Failed to delete submission');
                    }
                    alert('Submission deleted successfully');
                    fetchSubmissions(); // Refresh the table
                } catch (error) {
                    console.error('Error:', error);
                    alert('An error occurred while deleting the submission');
                }
            }
        };

        document.getElementById('refreshBtn').addEventListener('click', fetchSubmissions);

        // Initial fetch
        fetchSubmissions();
    </script>
</body>

</html>